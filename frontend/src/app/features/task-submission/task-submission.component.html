<div class="task-submission-container">
  <div class="section-label">Answer:</div>
  
  <form [formGroup]="taskForm" (ngSubmit)="onSubmit()" class="task-form">
    <mat-form-field appearance="outline" class="full-width">
      <textarea
        matInput
        formControlName="answer"
        placeholder="Enter your answer"
        rows="4"
      ></textarea>
      <mat-hint align="end" class="word-count">
        {{ getWordCount() }}/200
      </mat-hint>
      <mat-error *ngIf="taskForm.get('answer')?.hasError('required')">
        Answer is required
      </mat-error>
      <mat-error *ngIf="taskForm.get('answer')?.hasError('minlength')">
        Answer must not be empty
      </mat-error>
    </mat-form-field>

    <div class="form-actions">
      <button
        mat-raised-button
        color="primary"
        type="submit"
        [disabled]="taskForm.invalid || (loading$ | async)"
      >
        <mat-spinner
          diameter="20"
          *ngIf="loading$ | async"
          class="button-spinner"
        ></mat-spinner>
        <span>Submit Answer</span>
      </button>
    </div>

    <mat-error *ngIf="error$ | async as error" class="error-message">
      {{ error }}
    </mat-error>
  </form>
</div>
